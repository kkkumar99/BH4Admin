<!DOCTYPE html>
<html>
<head>
    <title>Ravi Boys Hostel-4 NITJ</title>
	<link rel="stylesheet"href="screen.css"media="screen"/>
    <link rel="stylesheet"href="print.css"media="print"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://www.gstatic.com/firebasejs/5.4.1/firebase.js"></script>

</head>
<body>
<div class="header" id="myHeader">
    <div class="container dark">
<div class="wrapper" id="top_div">
<div id="top_left">
    
    <img class="size-full wp-image-6269 aligncenter" src="nit jalandhar logo2.jpg" alt="" width="600" height="90" />
</div>
<div id="top_right">
<h3>Welcome Ravi Boys Hostel-4</h3>
</div>
<div id="clear">
</div>
</div>
</div>

</div>

<div class="content">
 <html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<div class="sidenav">
 <a href="addcircular.html"><font size="4">Â <span style="color: #993300;"><b>Add Circular </b></span></font></a>
    <a href="test.html"><font size="4">About</font></a>
    <a href="sturag.html"><font size="3">Student Registration</font></a>
  <a href="createpoll.html"><font size="4">Create Poll</font></a>
  <a href="pollresult.html"><font size="4">Poll Results</font></a>
   <a href="students.html"><font size="3">Student Record</font></a>
  <a href="messbill.html"><font size="4">Mess Bill</font></a>
  <a href="complaints.html"><font size="4">Complaints Track</font></a>
  <a href="dues.html"><font size="4">Account Dues</font></a>
	 <a href="hostelleave.html"><font size="4">Hostel leave</font></a>
     <br/><br/><br/>
      <a href="Login%20Page.html"><font size="5"><span style="color: coral;"><b>LogOut ?</b></span></font></a>
</div>

<div class="main">
    <font size="5"><span style="color: blueviolet;"><b>Add Circulars and Achievements</b></span></font><br/>
    <br/>
	<select name ="not" id="month" class="required-entry" required style="height:40px;width:130px;height:40px;background-color:coral;border-color:green;border-radius:8px">
	<option value="" disabled selected>Choose Type</option>
			<option value="c">Circulars</option>
            <option value="a">Achievements</option>
	     <option value="m">Mess Bill</option>
        </select></br></br>
	<font size="4"><span style="color: blueviolet;"><b>Title:</b></span></font><br/>
       <textarea name="titly" id="abc" style="width:600px; height:50px"></textarea></br>
	<input type="file" value="upload" id="myFile"></br>
	<input class="button" type="button" value="Submit" onclick="javascript:adddata(abc,month.value)"/>
    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
</div>
     
</body>
</html> 

</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js">
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">
</script>
<script>
  var config = {
    apiKey: "AIzaSyAX2YzZd3d6Z0iFW9eT11LM4rbe5PZcuNs",
    authDomain: "bh4-nitj.firebaseapp.com",
    databaseURL: "https://bh4-nitj.firebaseio.com",
    projectId: "bh4-nitj",
    storageBucket: "bh4-nitj.appspot.com",
    messagingSenderId: "287611465178"
  };
  firebase.initializeApp(config);
  var filebutton=document.getElementById('myFile');
  var uploader=document.getElementById('title');
  filebutton.addEventListener('change',function(e){
   var file=e.target.files[0];
   var storageref=firebase.storage().ref("circulars/"+file.name);
   var task=storageref.put(file);
  });
  function adddata(uploader,type){ 
  var input = document.getElementById('myFile');
  var file=input.files[0].name;
  console.log(uploader,file);
  if(type=="c"){
   var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://fcm.googleapis.com/fcm/send",
  "method": "POST",
  "headers": {
    "Content-Type": "application/json",
    "Authorization": "key=AAAAQvb6rdo:APA91bHxNjlpY_BEJTO69GDbxN58tH7Bfcf_SgUwJQss0qR48OrajPlDIw5n9tDRDtY98UFTeB5grYVi5cpMnHSbXbaIDQGQohc1qK6didUZFx68yr95PLLBdOHly9KNjWtsp5jKfCYN",
    "Cache-Control": "no-cache",
    "Postman-Token": "da9e1ddc-eed7-fd93-210e-1761bfd7da65"
  },
  "processData": false,
  "data": "{\r\n  \"to\": \"/topics/circulars\",\r\n  \r\n  \"notification\": {\r\n\t \"title\": \"New Circular Arrived\",\r\n      \"text\": \""+uploader.value+"\"\r\n  }\r\n}"
}
$.ajax(settings).done(function (response) {
  console.log(response);
});
  var playersRef =firebase.database().ref("circulars");  //this is to append new child data with default key
  playersRef.push ({
   "title":uploader.value,
   "link":file
  });
  alert("Data Successfully Entered\nWait for 10 seconds and then reload the page (ctrl+r) to continue.");
  }
  else if(type=="a"){
   var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://fcm.googleapis.com/fcm/send",
  "method": "POST",
  "headers": {
    "Content-Type": "application/json",
    "Authorization": "key=AAAAQvb6rdo:APA91bHxNjlpY_BEJTO69GDbxN58tH7Bfcf_SgUwJQss0qR48OrajPlDIw5n9tDRDtY98UFTeB5grYVi5cpMnHSbXbaIDQGQohc1qK6didUZFx68yr95PLLBdOHly9KNjWtsp5jKfCYN",
    "Cache-Control": "no-cache",
    "Postman-Token": "da9e1ddc-eed7-fd93-210e-1761bfd7da65"
  },
  "processData": false,
  "data": "{\r\n  \"to\": \"/topics/circulars\",\r\n  \r\n  \"notification\": {\r\n\t \"title\": \"New Achievement Arrived\",\r\n      \"text\": \""+uploader.value+"\"\r\n  }\r\n}"
}
$.ajax(settings).done(function (response) {
  console.log(response);
});
  var playersRef =firebase.database().ref("achievements");  //this is to append new child data with default key
  playersRef.push ({
   "title":uploader.value,
   "link":file
  });
  alert("Data Successfully Entered\nWait for 10 seconds and then reload the page (ctrl+r) to continue.");
  }
   else if(type=="m"){
   var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://fcm.googleapis.com/fcm/send",
  "method": "POST",
  "headers": {
    "Content-Type": "application/json",
    "Authorization": "key=AAAAQvb6rdo:APA91bHxNjlpY_BEJTO69GDbxN58tH7Bfcf_SgUwJQss0qR48OrajPlDIw5n9tDRDtY98UFTeB5grYVi5cpMnHSbXbaIDQGQohc1qK6didUZFx68yr95PLLBdOHly9KNjWtsp5jKfCYN",
    "Cache-Control": "no-cache",
    "Postman-Token": "da9e1ddc-eed7-fd93-210e-1761bfd7da65"
  },
  "processData": false,
  "data": "{\r\n  \"to\": \"/topics/circulars\",\r\n  \r\n  \"notification\": {\r\n\t \"title\": \"New Mess Bill Arrived\",\r\n      \"text\": \""+uploader.value+"\"\r\n  }\r\n}"
}
$.ajax(settings).done(function (response) {
  console.log(response);
});
  var playersRef =firebase.database().ref("messCirculars");  //this is to append new child data with default key
  playersRef.push ({
   "title":uploader.value,
   "link":file
  });
  alert("Data Successfully Entered\nWait for 10 seconds and then reload the page (ctrl+r) to continue.");
  }
  }
</script>
<script>
window.onscroll = function() {myFunction()};

var header = document.getElementById("myHeader");
var sticky = header.offsetTop;

function myFunction() {
  if (window.pageYOffset > sticky) {
    header.classList.add("sticky");
  } else {
    header.classList.remove("sticky");
  }
}
</script>

</body>
</html>

